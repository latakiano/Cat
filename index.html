<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Cat: Global Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Arial', sans-serif; touch-action: none; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        #ui { position: absolute; top: 15px; width: 100%; display: flex; justify-content: space-around; z-index: 100; pointer-events: none; }
        .stat-item { background: rgba(0, 0, 0, 0.7); border: 1.5px solid #00f2ff; padding: 8px 15px; border-radius: 12px; color: #fff; font-weight: bold; box-shadow: 0 0 10px rgba(0, 242, 255, 0.3); }

        /* Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        #overlay, #shop { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; color: #fff; text-align: center; }
        #shop { display: none; background: radial-gradient(circle, #1a0033 0%, #000 100%); }

        .btn { padding: 15px 40px; font-size: 20px; background: linear-gradient(45deg, #00f2ff, #0062ff); color: #fff; border: none; cursor: pointer; border-radius: 30px; margin: 10px; transition: 0.3s; font-weight: bold; }
        .btn-shop { background: linear-gradient(45deg, #ffae00, #ff4500); }
        .btn:hover { transform: scale(1.05); }

        .item-card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin: 10px; border: 1px solid #ffae00; width: 250px; }
    </style>
</head>
<body>

<div id="ui">
    <div class="stat-item"><span id="txt-lvl">Ø§Ù„Ù…Ø±Ø­Ù„Ø©</span>: <span id="lvlText">1</span></div>
    <div class="stat-item">ğŸ’° <span id="coinText">0</span></div>
</div>

<div id="overlay">
    <h1 id="txt-title" style="font-size: 40px; color: #00f2ff;">ÙƒØ§Ø¨ÙˆØ³ Ø§Ù„Ù‡Ù…Ù„Ø§ÙŠØ§ ğŸˆ</h1>
    <button class="btn" onclick="initGame()" id="txt-start">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¹Ø±ÙƒØ©</button>
    <button class="btn btn-shop" onclick="toggleShop(true)" id="txt-open-shop">Ø§Ù„Ù…ØªØ¬Ø± (0.30$)</button>
</div>

<div id="shop">
    <h1 id="txt-shop-title">Ù…ØªØ¬Ø± Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª ğŸ›’</h1>
    <div style="display: flex; flex-wrap: wrap; justify-content: center;">
        <div class="item-card">
            <h3>Ù‚Ø·Ø© Ø³ÙˆØ¨Ø± ğŸ¾</h3>
            <p>Ù‚ÙØ²Ø© Ø£Ø¹Ù„Ù‰ ÙˆØ³Ø±Ø¹Ø© Ø£ÙƒØ¨Ø±</p>
            <button class="btn btn-shop" onclick="buyItem('cat')">0.30 $</button>
        </div>
        <div class="item-card">
            <h3>Ø³Ù„Ø§Ø­ Ø§Ù„Ù„ÙŠØ²Ø± ğŸ”«</h3>
            <p>ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
            <button class="btn btn-shop" onclick="buyItem('weapon')">0.30 $</button>
        </div>
    </div>
    <button class="btn" onclick="toggleShop(false)">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
    
    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ù„ØºØ§Øª ---
    const lang = navigator.language.startsWith('ar') ? 'ar' : 'en';
    const texts = {
        ar: { title: "ÙƒØ§Ø¨ÙˆØ³ Ø§Ù„Ù‡Ù…Ù„Ø§ÙŠØ§ ğŸˆ", start: "Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¹Ø±ÙƒØ©", shop: "Ø§Ù„Ù…ØªØ¬Ø± (0.30$)", lvl: "Ø§Ù„Ù…Ø±Ø­Ù„Ø©", shopTitle: "Ù…ØªØ¬Ø± Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª" },
        en: { title: "Himalayan Nightmare ğŸˆ", start: "Start Game", shop: "Shop ($0.30)", lvl: "Level", shopTitle: "Upgrades Shop" }
    };
    document.getElementById('txt-title').innerText = texts[lang].title;
    document.getElementById('txt-start').innerText = texts[lang].start;
    document.getElementById('txt-open-shop').innerText = texts[lang].shop;
    document.getElementById('txt-lvl').innerText = texts[lang].lvl;
    document.getElementById('txt-shop-title').innerText = texts[lang].shopTitle;

    // --- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ø±Ø§Ø­Ù„ ---
    const assets = {
        cat: 'https://img.icons8.com/color/96/cat--v1.png',
        catSuper: 'https://img.icons8.com/color/96/cat-mask.png',
        wolf: 'https://img.icons8.com/color/150/werewolf.png',
        ghost: 'https://img.icons8.com/color/150/grim-reaper.png',
        dragon: 'https://img.icons8.com/color/150/dragon.png',
        lion: 'https://img.icons8.com/color/150/lion.png'
    };
    const imgObj = {}; Object.keys(assets).forEach(k => { imgObj[k] = new Image(); imgObj[k].src = assets[k]; });

    const STAGES = Array.from({length: 20}, (_, i) => ({
        type: ['wolf', 'ghost', 'lion', 'dragon'][i % 4],
        neon: ['#00f2ff', '#ff0055', '#ffae00', '#7a00ff'][i % 4],
        speed: 7 + (i * 0.5)
    }));

    let curStage = 0, distance = 1000, active = false, started = false, score = 0;
    let p = { x: 120, y: 0, v: 0, power: 1 }, m = { x: -300, y: 0 };
    let obstacles = [], coins = [], hasWeapon = false;

    function initGame() {
        document.getElementById('overlay').style.display = 'none';
        distance = 1000; p.y = canvas.height / 2; p.v = 0; m.x = -300;
        obstacles = []; coins = []; active = true; started = false;
        document.getElementById('lvlText').innerText = curStage + 1;
    }

    function toggleShop(show) { document.getElementById('shop').style.display = show ? 'flex' : 'none'; }

    function buyItem(type) {
        alert("Ø³Ø¹Ø± Ø§Ù„Ø³Ù„Ø¹Ø© 0.30 Ø¯ÙˆÙ„Ø§Ø± (ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ù„Ø±Ø¨Ø· Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹)");
        if(type === 'cat') p.power = 1.5;
        if(type === 'weapon') hasWeapon = true;
        toggleShop(false);
    }

    function gameLoop() {
        let s = STAGES[curStage];
        ctx.fillStyle = "#050505"; ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (active && started) {
            p.v += 0.5; p.y += p.v; distance -= 0.5;
            m.y += (p.y - m.y) * 0.05; m.x = Math.min(p.x - 140, m.x + 0.3);

            // ØªÙˆÙ„ÙŠØ¯ Ø¹ÙˆØ§Ø¦Ù‚ ÙˆØ¬ÙˆØ§Ø¦Ø²
            if (Math.random() < 0.02) {
                obstacles.push({ x: canvas.width, y: Math.random()*(canvas.height-300)+100, h: 250 });
            }
            if (Math.random() < 0.03) {
                coins.push({ x: canvas.width, y: Math.random()*canvas.height });
            }

            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ (ØªØ®ÙÙŠÙ Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø¹Ø¨Ø± Ø´ÙØ§ÙÙŠØ© Ø§Ù„Ù†ÙŠÙˆÙ†)
            obstacles.forEach((o, i) => {
                o.x -= s.speed;
                ctx.fillStyle = s.neon; ctx.globalAlpha = 0.6; // ØªØ®ÙÙŠÙ Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©
                ctx.fillRect(o.x, 0, 50, o.y); ctx.fillRect(o.x, o.y + o.h, 50, canvas.height);
                ctx.globalAlpha = 1.0;
                
                if (hasWeapon && Math.abs(p.x - o.x) < 100) obstacles.splice(i, 1); // Ø§Ù„Ø³Ù„Ø§Ø­ ÙŠØ¯Ù…Ø± Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚
                if (p.x + 40 > o.x && p.x < o.x + 50 && (p.y < o.y || p.y + 40 > o.y + o.h)) active = false;
            });

            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²
            coins.forEach((c, i) => {
                c.x -= s.speed;
                ctx.font = "25px Arial"; ctx.fillText("ğŸ’°", c.x, c.y);
                if (Math.hypot(p.x - c.x, p.y - c.y) < 40) { score += 10; coins.splice(i, 1); }
            });

            if (p.y > canvas.height || p.y < -50 || p.x < m.x + 50) active = false;
            if (!active) document.getElementById('overlay').style.display = 'flex';
            document.getElementById('coinText').innerText = score;
        }

        // --- Ø±Ø³Ù… Ø§Ù„ÙˆØ­Ø´ (Ø¨Ø¯ÙˆÙ† Ø¯Ø§Ø¦Ø±Ø©ØŒ ÙˆØ¨Ø¥ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø·Ø©) ---
        ctx.save();
        ctx.translate(m.x + 150, m.y);
        ctx.scale(-1, 1); // Ù‚Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ù„ØªÙˆØ§Ø¬Ù‡ Ø§Ù„ÙŠÙ…ÙŠÙ† (Ø§Ù„Ù‚Ø·Ø©)
        ctx.drawImage(imgObj[s.type], 0, 0, 150, 150);
        ctx.restore();

        // Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø© (Ø¹Ø§Ø¯ÙŠØ© Ø£Ùˆ Ù…Ø·ÙˆØ±Ø©)
        ctx.drawImage(p.power > 1 ? imgObj.catSuper : imgObj.cat, p.x, p.y, 70, 70);

        requestAnimationFrame(gameLoop);
    }

    const jump = () => { if (active) { started = true; p.v = -8 * p.power; } }
    window.onmousedown = jump; window.ontouchstart = jump;
    window.onresize = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
    window.onresize();
    gameLoop();
</script>
</body>
</html>