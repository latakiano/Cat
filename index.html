<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Legends: Cat Savior Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #050508; font-family: 'Arial', sans-serif; touch-action: none; color: white; }
        #ui { position: absolute; top: 10px; width: 100%; display: flex; justify-content: space-around; z-index: 100; pointer-events: none; }
        .stat { background: rgba(0,0,0,0.8); border: 2px solid #ffd700; padding: 5px 15px; border-radius: 15px; font-weight: bold; font-size: 14px; }
        
        /* Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .screen { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; }
        .btn { padding: 15px 40px; font-size: 20px; background: gold; border: none; border-radius: 50px; color: #000; cursor: pointer; font-weight: bold; margin: 10px; box-shadow: 0 5px 15px gold; }
        .btn-shop { background: #00f2ff; box-shadow: 0 5px 15px #00f2ff; }
        
        #canvas { display: block; width: 100vw; height: 100vh; }
    </style>
</head>
<body>

<div id="ui">
    <div class="stat">ğŸ° <span id="loc">LONDON</span></div>
    <div class="stat">ğŸ’° <span id="scr">0</span></div>
    <div class="stat">âš¡ <span id="lvl">CAT Lvl 1</span></div>
</div>

<div id="startScreen" class="screen">
    <h1 style="color: gold; margin-bottom: 5px;">Ù…ÙÙ†Ù‚Ø° Ø§Ù„Ù‚Ø·Ø· Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠ</h1>
    <p id="msg">Ù„Ø¯ÙŠÙƒ 45 Ù‚Ø·Ø© ØªÙ†ØªØ¸Ø±Ùƒ.. Ø§Ø¬Ù…Ø¹ Ø§Ù„Ø°Ù‡Ø¨ Ù„ØªØ·ÙˆÙŠØ±Ù‡Ù…!</p>
    <button class="btn" onclick="start()">Ø¨Ø¯Ø¡ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©</button>
    <button class="btn btn-shop" id="upgradeBtn" onclick="upgradeCat()">ØªØ·ÙˆÙŠØ± Ø§Ù„Ù‚Ø·Ø© (Cost: 50$)</button>
</div>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas'), ctx = canvas.getContext('2d');
let gameActive = false, score = 0, catLevel = 1, coinsToNextLevel = 50;
let curStage = 0, dist = 0;

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø© Ù„ØªÙ†Ø§Ø³Ø¨ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø·ÙˆÙ„
function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.onresize = resize;
resize();

let p = { x: 80, y: 0, v: 0, gravity: 0.5, jump: -9 };
let monster = { x: -200, y: 0, size: 80 };
let obs = [], coins = [];

const stages = ["LONDON", "PARIS", "ROME", "DUBAI", "LATAKIA"];
const colors = ["#ffd700", "#ff4500", "#00f2ff", "#7fff00", "#ffffff"];

function drawCat(x, y, level) {
    ctx.save();
    ctx.translate(x, y);
    // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ù‚Ø·Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
    let catColor = level === 1 ? "white" : (level === 2 ? "#f0f0f0" : "#ffd700");
    let eyeColor = level >= 3 ? "red" : "blue";
    
    // Ø§Ù„Ø¬Ø³Ù…
    ctx.fillStyle = catColor;
    ctx.beginPath(); ctx.ellipse(30, 30, 25, 18, 0, 0, Math.PI*2); ctx.fill();
    // Ø§Ù„Ø±Ø£Ø³
    ctx.beginPath(); ctx.arc(50, 20, 15, 0, Math.PI*2); ctx.fill();
    // Ø§Ù„Ø£Ø°Ù†ÙŠÙ†
    ctx.fillStyle = "#5D4037";
    ctx.beginPath(); ctx.moveTo(45, 10); ctx.lineTo(40, 0); ctx.lineTo(50, 5); ctx.fill();
    ctx.beginPath(); ctx.moveTo(55, 10); ctx.lineTo(60, 0); ctx.lineTo(50, 5); ctx.fill();
    // Ø§Ù„Ø¹ÙŠÙˆÙ†
    ctx.fillStyle = eyeColor;
    ctx.beginPath(); ctx.arc(55, 18, 3, 0, Math.PI*2); ctx.fill();
    ctx.restore();
}

function drawMonster(x, y) {
    ctx.save();
    ctx.translate(x, y);
    // Ø¬Ø³Ù… Ø§Ù„ÙˆØ­Ø´ (Ø´ÙƒÙ„ ÙƒØ§Ø¦Ù† ÙØ¶Ø§Ø¦ÙŠ Ø¨Ø£Ø³Ù†Ø§Ù†)
    ctx.fillStyle = "#4a0000";
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.quadraticCurveTo(80, -20, 100, 40);
    ctx.quadraticCurveTo(80, 100, 0, 80);
    ctx.closePath(); ctx.fill();
    
    // Ø§Ù„Ø¹ÙŠÙ† Ø§Ù„Ø­Ù…Ø±Ø§Ø¡
    ctx.fillStyle = "red";
    ctx.beginPath(); ctx.arc(70, 30, 8, 0, Math.PI*2); ctx.fill();
    
    // Ø§Ù„Ø£Ø³Ù†Ø§Ù†
    ctx.fillStyle = "white";
    for(let i=0; i<3; i++) {
        ctx.beginPath();
        ctx.moveTo(70+(i*10), 50); ctx.lineTo(75+(i*10), 65); ctx.lineTo(80+(i*10), 50); ctx.fill();
    }
    ctx.restore();
}

function upgradeCat() {
    if (score >= coinsToNextLevel) {
        score -= coinsToNextLevel;
        catLevel++;
        coinsToNextLevel *= 2;
        p.gravity -= 0.05; // ØªØµØ¨Ø­ Ø£Ø®Ù
        p.jump -= 0.5;    // ØªÙ‚ÙØ² Ø£Ø¹Ù„Ù‰
        document.getElementById('upgradeBtn').innerText = `ØªØ·ÙˆÙŠØ± Ø§Ù„Ù‚Ø·Ø© (Cost: ${coinsToNextLevel}$)`;
        document.getElementById('scr').innerText = score;
        document.getElementById('lvl').innerText = `CAT Lvl ${catLevel}`;
        alert("Ù…Ø¨Ø±ÙˆÙƒ! Ø§Ù„Ù‚Ø·Ø© Ø£ØµØ¨Ø­Øª Ø£Ù‚ÙˆÙ‰ Ø§Ù„Ø¢Ù†!");
    } else {
        alert("ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø°Ù‡Ø¨ Ù…Ù† Ø§Ù„Ø¯Ù‡Ø§Ù„ÙŠØ²!");
    }
}

function start() {
    document.getElementById('startScreen').style.display = 'none';
    p.y = canvas.height/2; p.v = 0;
    obs = []; coins = []; monster.x = -200;
    gameActive = true;
}

function loop() {
    ctx.fillStyle = "#050510"; ctx.fillRect(0, 0, canvas.width, canvas.height);

    if (gameActive) {
        p.v += p.gravity; p.y += p.v;
        monster.y += (p.y - monster.y) * 0.04; 
        monster.x = Math.min(p.x - 120, monster.x + 0.3);

        if (obs.length === 0 || obs[obs.length-1].x < canvas.width - 450) {
            obs.push({ x: canvas.width, y: Math.random()*(canvas.height-300)+50, h: 250 });
        }
        if (Math.random() < 0.015) coins.push({ x: canvas.width, y: Math.random()*(canvas.height-100)+50 });

        obs.forEach((o, i) => {
            o.x -= (5 + curStage);
            ctx.fillStyle = colors[curStage]; ctx.globalAlpha = 0.3;
            ctx.fillRect(o.x, 0, 60, o.y); ctx.fillRect(o.x, o.y+o.h, 60, canvas.height);
            ctx.globalAlpha = 1;
            if (p.x+50 > o.x && p.x < o.x+60 && (p.y+10 < o.y || p.y+40 > o.y+o.h)) gameActive = false;
        });

        coins.forEach((c, i) => {
            c.x -= (5 + curStage);
            ctx.fillStyle = "gold"; ctx.beginPath(); ctx.arc(c.x, c.y, 12, 0, Math.PI*2); ctx.fill();
            if (Math.hypot(p.x+30 - c.x, p.y+25 - c.y) < 35) { score += 10; coins.splice(i, 1); }
        });

        if (p.y > canvas.height || p.y < -50 || p.x < monster.x + 80) gameActive = false;
        
        dist++; if(dist > 1500 && curStage < 4) { curStage++; dist = 0; }
    } else {
        document.getElementById('startScreen').style.display = 'flex';
        document.getElementById('scr').innerText = score;
    }

    drawMonster(monster.x, monster.y);
    drawCat(p.x, p.y, catLevel);
    
    document.getElementById('scr').innerText = score;
    document.getElementById('loc').innerText = stages[curStage];
    requestAnimationFrame(loop);
}

window.onmousedown = () => { if(gameActive) p.v = p.jump; };
window.ontouchstart = (e) => { e.preventDefault(); if(gameActive) p.v = p.jump; };
loop();
</script>
</body>
</html>