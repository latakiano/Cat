<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Cat: The Journey Home</title>
    <style>
        :root { --gold: #ffd700; --snow: #f0f0f0; }
        body { margin: 0; background: #050510; overflow: hidden; font-family: 'Arial', sans-serif; touch-action: none; }
        #game-ui { position: fixed; top: 10px; width: 100%; display: flex; justify-content: space-around; z-index: 50; color: white; font-weight: bold; pointer-events: none; }
        .bar-container { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 80%; height: 10px; background: rgba(255,255,255,0.2); border-radius: 5px; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: var(--gold); transition: 0.1s; }
        #menu { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; color: var(--gold); }
        .btn { padding: 15px 60px; font-size: 22px; background: var(--gold); border: none; border-radius: 30px; cursor: pointer; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

<div id="game-ui">
    <div>Stage: <span id="stg-val">1</span></div>
    <div>Gold: <span id="gld-val">0</span></div>
</div>
<div class="bar-container"><div id="progress-bar"></div></div>

<div id="menu">
    <h1 style="font-size: 35px;">HIMALAYAN CAT 2026</h1>
    <p>Help the cat reach the Hut!</p>
    <button class="btn" onclick="start()">START GAME</button>
</div>

<canvas id="c"></canvas>

<script>
const cvs = document.getElementById('c'), ctx = cvs.getContext('2d');
let active = false, stage = 1, gold = 0, distance = 0, maxDist = 3000;
let frame = 0;

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø·Ø© (Ø§Ù„Ù‡Ù…Ù„Ø§ÙŠØ§: Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø¹ Ø£Ø°Ù†ÙŠÙ† Ø¯Ø§ÙƒÙ†Ø©)
let p = { x: 100, y: 0, v: 0, g: 0.5, j: -8, w: 60, h: 45, speedX: 2 };
let wolf = { x: -200, y: 0 };
let obs = [], hut = { x: -1000, y: 0, show: false };

function resize() { cvs.width = window.innerWidth; cvs.height = window.innerHeight; }
window.onresize = resize; resize();

function start() {
    document.getElementById('menu').style.display = 'none';
    p.y = cvs.height / 2;
    active = true;
    requestAnimationFrame(loop);
}

// Ø§Ù„Ù„Ù…Ø³ ÙŠØ²ÙŠØ¯ Ø§Ù„Ø³Ø±Ø¹Ø© (Impulse Physics)
window.onmousedown = () => { if(active) { p.v = p.j; p.speedX = Math.min(8, p.speedX + 0.5); } };
window.ontouchstart = (e) => { if(active) { p.v = p.j; p.speedX = Math.min(8, p.speedX + 0.5); } e.preventDefault(); };

function drawCat(x, y) {
    ctx.save();
    ctx.translate(x, y);
    // Ø¬Ø³Ù… Ø§Ù„Ù‚Ø·Ø© (Ù‡Ù…Ù„Ø§ÙŠØ§ Ø¨ÙŠØ¶Ø§Ø¡)
    ctx.fillStyle = "#FFFFFF";
    ctx.beginPath(); ctx.ellipse(0, 0, 25, 18, 0, 0, Math.PI*2); ctx.fill();
    // Ø§Ù„Ø±Ø£Ø³ ÙˆØ§Ù„Ø£Ø°Ù†ÙŠÙ† Ø§Ù„Ø¯Ø§ÙƒÙ†Ø©
    ctx.beginPath(); ctx.arc(20, -10, 12, 0, 7); ctx.fill();
    ctx.fillStyle = "#4b3621"; // Ù„ÙˆÙ† Ø§Ù„Ø£Ø°Ù† Ø¨Ù†ÙŠ Ø¯Ø§ÙƒÙ† (Ù‡Ù…Ù„Ø§ÙŠØ§)
    ctx.beginPath(); ctx.moveTo(15, -18); ctx.lineTo(18, -30); ctx.lineTo(22, -18); ctx.fill();
    ctx.beginPath(); ctx.moveTo(25, -18); ctx.lineTo(28, -30); ctx.lineTo(31, -18); ctx.fill();
    ctx.restore();
}

function drawHut(x, y) {
    ctx.fillStyle = "#8b4513"; // Ø¬Ø¯Ø±Ø§Ù† Ø§Ù„ÙƒÙˆØ®
    ctx.fillRect(x, y - 60, 100, 80);
    ctx.fillStyle = "#ff4500"; // Ø§Ù„Ø³Ù‚Ù
    ctx.beginPath(); ctx.moveTo(x - 20, y - 60); ctx.lineTo(x + 50, y - 110); ctx.lineTo(x + 120, y - 60); ctx.fill();
    ctx.fillStyle = "#fff"; ctx.font = "20px Arial"; ctx.fillText("FINISH", x + 20, y - 30);
}

function loop() {
    if(!active) return;
    ctx.fillStyle = "#050510"; ctx.fillRect(0, 0, cvs.width, cvs.height);

    // Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡
    p.v += p.g; p.y += p.v;
    p.speedX = Math.max(2, p.speedX - 0.02); // ØªØ¨Ø§Ø·Ø¤ Ø·Ø¨ÙŠØ¹ÙŠ
    distance += p.speedX;
    
    // Ù…Ù„Ø§Ø­Ù‚Ø© Ø§Ù„Ø°Ø¦Ø¨ (Ø®Ù„Ù Ø§Ù„Ù‚Ø·Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨Ù…Ø³Ø§ÙØ©)
    wolf.y += (p.y - wolf.y) * 0.05;
    wolf.x = p.x - 150 + (Math.sin(frame*0.05) * 20);

    // Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
    let progress = (distance / maxDist) * 100;
    document.getElementById('progress-bar').style.width = Math.min(100, progress) + "%";

    // Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø© ÙˆØ§Ù„Ø°Ø¦Ø¨
    drawCat(p.x, p.y);
    ctx.font = "60px Arial"; ctx.fillText("ğŸº", wolf.x, wolf.y + 20);

    // Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ (Ø§Ù„Ø¯Ù‡Ø§Ù„ÙŠØ²)
    if(frame % 100 == 0 && distance < maxDist - 500) {
        let h = Math.random() * (cvs.height - 300) + 100;
        obs.push({x: cvs.width, y: 0, h: h});
        obs.push({x: cvs.width, y: h + 220, h: cvs.height});
    }

    obs.forEach((o, i) => {
        o.x -= p.speedX;
        ctx.fillStyle = "#00d2ff"; ctx.fillRect(o.x, o.y, 60, o.h);
        if(p.x+20 > o.x && p.x-20 < o.x+60 && (p.y-15 < o.y+o.h && p.y+15 > o.y)) die();
        if(o.x < -100) obs.splice(i, 1);
    });

    // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø±Ø­Ù„Ø© (Ø§Ù„ÙƒÙˆØ®)
    if(distance >= maxDist && !hut.show) { hut.show = true; hut.x = cvs.width; hut.y = p.y; }
    if(hut.show) {
        hut.x -= p.speedX;
        drawHut(hut.x, hut.y);
        if(p.x > hut.x) { nextStage(); }
    }

    if(p.y > cvs.height || p.y < 0 || p.x < wolf.x + 50) die();
    frame++;
    requestAnimationFrame(loop);
}

function nextStage() {
    active = false; stage++; distance = 0; hut.show = false; obs = [];
    alert("Great! Stage " + stage + " is starting!");
    document.getElementById('stg-val').innerText = stage;
    maxDist += 1000;
    active = true; loop();
}

function die() { active = false; alert("The wolf caught you! Try again."); location.reload(); }
</script>
</body>
</html>