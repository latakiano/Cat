<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Legends: Monster Galaxy</title>
    <style>
        :root { --gold: #ffd700; --neon: #00f2ff; }
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Arial', sans-serif; touch-action: none; color: white; }
        #ui { position: absolute; top: 10px; width: 100%; display: flex; flex-direction: column; align-items: center; z-index: 100; pointer-events: none; }
        .stat-box { background: rgba(0,0,0,0.8); border: 2px solid var(--gold); padding: 5px 15px; border-radius: 10px; font-weight: bold; margin: 2px; display: inline-block; }
        #progress-bar { width: 0%; height: 8px; background: var(--neon); transition: 0.3s; margin-top: 5px; box-shadow: 0 0 10px var(--neon); }
        .screen { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; }
        .btn { padding: 15px 40px; font-size: 20px; background: var(--gold); border: none; border-radius: 50px; color: #000; cursor: pointer; font-weight: bold; margin: 10px; }
    </style>
</head>
<body>

<div id="ui">
    <div>
        <div class="stat-box">ğŸŒ <span id="city-name">LONDON</span></div>
        <div class="stat-box">ğŸ’° <span id="gold-val">0</span></div>
    </div>
    <div style="width: 80%; background: #222; border-radius: 5px;"><div id="progress-bar"></div></div>
</div>

<div id="startScreen" class="screen">
    <h1 id="title" style="color: var(--gold);">Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„ÙƒÙ‡ÙˆÙ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ©</h1>
    <p id="desc">ÙˆØ§Ø¬Ù‡ Ø§Ù„ÙˆØ­ÙˆØ´ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø§Ø°Ù‚ÙŠØ©!</p>
    <button class="btn" onclick="game.start()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø±Ø­Ù„Ø©</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
const STAGES = [
    {n: "LONDON", m: "DRAGON", c: "#FF3131"},
    {n: "PARIS", m: "SHARK", c: "#00FFFF"},
    {n: "ROME", m: "SPIDER", c: "#39FF14"},
    {n: "DUBAI", m: "EAGLE", c: "#FFAC1C"},
    {n: "LATAKIA", m: "LION", c: "#FFD700"}
];

let audioCtx;
function playSound(f, d) {
    if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    let o = audioCtx.createOscillator(), g = audioCtx.createGain();
    o.frequency.value = f; g.gain.value = 0.1;
    o.connect(g).connect(audioCtx.destination);
    o.start(); o.stop(audioCtx.currentTime + d);
}

let game = {
    active: false, gold: 0, cur: 0, dist: 0, target: 2000,
    init() { this.resize(); window.onresize = () => this.resize(); this.loop(); },
    resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; },
    start() { 
        document.getElementById('startScreen').style.display = 'none';
        p.y = canvas.height/2; p.v = 0; enemy.x = -300; 
        obs = []; items = []; this.dist = 0; portal = null; this.active = true; 
    },
    win() {
        this.active = false; this.cur = (this.cur + 1) % STAGES.length;
        document.getElementById('startScreen').style.display = 'flex';
        document.getElementById('title').innerText = "ØªÙ… Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„ÙƒÙ‡Ù!";
        document.getElementById('desc').innerText = "Ø§Ù„ÙˆØ¬Ù‡Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: " + STAGES[this.cur].n;
    }
};

let p = { x: 120, y: 0, v: 0, g: 0.5, jump: -10 };
let enemy = { x: -300, y: 0 };
let obs = [], items = [], portal = null;

function drawCat(x, y) {
    ctx.save(); ctx.translate(x, y);
    ctx.fillStyle = "white";
    ctx.beginPath(); ctx.ellipse(30, 25, 22, 16, 0, 0, Math.PI*2); ctx.fill(); // Ø§Ù„Ø¬Ø³Ù…
    ctx.fillRect(15, 38, 6, 10); ctx.fillRect(40, 38, 6, 10); // Ø£Ø±Ø¬Ù„
    ctx.beginPath(); ctx.arc(50, 15, 12, 0, Math.PI*2); ctx.fill(); // Ø±Ø£Ø³
    ctx.fillStyle = "#5D4037"; ctx.beginPath(); ctx.moveTo(45, 5); ctx.lineTo(40, -5); ctx.lineTo(50, 3); ctx.fill();
    ctx.fillStyle = "blue"; ctx.beginPath(); ctx.arc(55, 13, 2, 0, Math.PI*2); ctx.fill();
    ctx.restore();
}

function drawMonster(x, y, type) {
    ctx.save(); ctx.translate(x, y);
    ctx.fillStyle = STAGES[game.cur].c;
    if(type === "DRAGON") { // ØªÙ†ÙŠÙ† Ø¨ÙÙƒ ÙˆØ§Ø³Ø¹
        ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(130, 20); ctx.lineTo(100, 40); ctx.lineTo(130, 60); ctx.lineTo(0,80); ctx.fill();
    } else if(type === "SHARK") { // Ù‚Ø±Ø´ Ø¨Ø²Ø¹Ø§Ù†Ù
        ctx.beginPath(); ctx.ellipse(60, 40, 70, 30, 0, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.moveTo(40, 10); ctx.lineTo(60, -20); ctx.lineTo(80, 10); ctx.fill();
    } else if(type === "SPIDER") { // Ø¹Ù†ÙƒØ¨ÙˆØª Ø¨Ù€ 8 Ø£Ø±Ø¬Ù„
        ctx.beginPath(); ctx.arc(60, 40, 30, 0, Math.PI*2); ctx.fill();
        for(let i=0; i<4; i++) { ctx.fillRect(30, 20+i*15, 60, 4); }
    } else { // Ø§Ù„Ø£Ø³Ø¯ (Ø§Ù„Ù„Ø§Ø°Ù‚ÙŠØ©)
        ctx.beginPath(); ctx.arc(60, 40, 45, 0, Math.PI*2); ctx.fill(); // Ù„Ø¨Ø¯Ø© Ø§Ù„Ø£Ø³Ø¯
        ctx.fillStyle = "#ffa500"; ctx.beginPath(); ctx.arc(60, 40, 30, 0, Math.PI*2); ctx.fill();
    }
    // Ø£Ø³Ù†Ø§Ù† Ø¨ÙŠØ¶Ø§Ø¡ ÙˆØ¹ÙŠÙ† Ø­Ù…Ø±Ø§Ø¡ Ù„Ù„ÙƒÙ„
    ctx.fillStyle = "white"; for(let i=0; i<3; i++) ctx.fillRect(100+i*10, 35, 5, 10);
    ctx.fillStyle = "red"; ctx.beginPath(); ctx.arc(80, 25, 6, 0, Math.PI*2); ctx.fill();
    ctx.restore();
}

function update() {
    if(!game.active) return;
    p.v += p.g; p.y += p.v;
    enemy.y += (p.y - enemy.y) * 0.05;
    enemy.x = Math.min(p.x - 120, enemy.x + (0.5 + game.cur*0.1));

    game.dist += 3;
    document.getElementById('progress-bar').style.width = (game.dist/game.target*100) + "%";

    // Ø¸Ù‡ÙˆØ± Ø§Ù„ÙƒÙ‡Ù ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
    if(game.dist >= game.target && !portal) portal = { x: canvas.width, y: canvas.height/2 - 100 };

    if(portal) {
        portal.x -= 5;
        if(p.x > portal.x) game.win();
    } else {
        if(obs.length === 0 || obs[obs.length-1].x < canvas.width - 450) {
            obs.push({ x: canvas.width, y: Math.random()*(canvas.height-300)+50, h: 250 });
        }
    }

    obs.forEach((o, i) => {
        o.x -= 6;
        if(p.x+50 > o.x && p.x < o.x+50 && (p.y < o.y || p.y+45 > o.y+o.h)) game.active = false;
    });

    if(p.y > canvas.height || p.y < -50 || p.x < enemy.x + 80) { game.active = false; document.getElementById('startScreen').style.display = 'flex'; }
}

function draw() {
    ctx.fillStyle = "#050508"; ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    if(portal) { // Ø±Ø³Ù… Ø§Ù„ÙƒÙ‡Ù
        ctx.fillStyle = STAGES[game.cur].c; ctx.shadowBlur = 30; ctx.shadowColor = "white";
        ctx.beginPath(); ctx.arc(portal.x+100, portal.y+100, 150, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = "black"; ctx.beginPath(); ctx.arc(portal.x+100, portal.y+100, 120, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = "white"; ctx.font = "bold 20px Arial"; ctx.fillText("Ù…Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ‡Ù", portal.x+50, portal.y+100);
        ctx.shadowBlur = 0;
    }

    obs.forEach(o => {
        ctx.fillStyle = STAGES[game.cur].c; ctx.fillRect(o.x, 0, 50, o.y); ctx.fillRect(o.x, o.y+o.h, 50, canvas.height);
    });

    drawMonster(enemy.x, enemy.y, STAGES[game.cur].m);
    drawCat(p.x, p.y);
    document.getElementById('city-name').innerText = STAGES[game.cur].n;
}

function loop() { update(); draw(); requestAnimationFrame(() => game.loop()); }
window.onmousedown = () => { if(game.active) { p.v = p.jump; playSound(200, 0.1); } };
window.ontouchstart = (e) => { e.preventDefault(); if(game.active) { p.v = p.jump; playSound(200, 0.1); } };
game.init();
</script>
</body>
</html>