<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Legends: The Ultimate Reality</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Arial Black', sans-serif; touch-action: none; color: white; }
        #ui { position: absolute; top: 15px; width: 100%; display: flex; justify-content: space-around; z-index: 100; pointer-events: none; }
        .stat-card { background: rgba(0,0,0,0.8); border: 2px solid #ffd700; padding: 10px 18px; border-radius: 20px; font-size: 18px; box-shadow: 0 0 15px #ffd700; }
        .screen { position: fixed; inset: 0; background: radial-gradient(circle, #1a0033 0%, #000 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; }
        .btn { padding: 18px 60px; font-size: 24px; background: linear-gradient(45deg, #ffd700, #ff8c00); border: none; border-radius: 50px; color: #000; cursor: pointer; font-weight: bold; transition: 0.3s; margin-top: 20px; box-shadow: 0 5px 15px rgba(255,215,0,0.4); }
        .btn:hover { transform: scale(1.1); box-shadow: 0 0 30px #ffd700; }
    </style>
</head>
<body>

<div id="ui">
    <div class="stat-card">üè∞ <span id="locName">LONDON</span></div>
    <div class="stat-card">üí∞ <span id="scoreVal">0</span></div>
    <div class="stat-card" style="border-color: #00f2ff;">üèÜ <span id="bestVal">0</span></div>
</div>

<div id="startScreen" class="screen">
    <h1 style="font-size: 3.5rem; text-shadow: 0 0 20px #ffd700;">HIMALAYAN LEGENDS</h1>
    <p style="color: #ccc;">20 Dungeons ‚Ä¢ 20 Challenges ‚Ä¢ 1 Legend</p>
    <div id="bText" style="color: #00f2ff; font-size: 1.5rem;">BEST: 0</div>
    <button class="btn" onclick="game.start()">START MISSION</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
let audioCtx;

// --- ÿßŸÑÿ£ÿµŸàŸÑ (ÿßŸÑÿµŸàÿ± ÿßŸÑÿ£ÿµŸÑŸäÿ©) ---
const assets = {
    cat: 'https://img.icons8.com/color/96/cat--v1.png',
    coin: 'https://img.icons8.com/color/48/gold-pot.png',
    wolf: 'https://img.icons8.com/fluency/150/werewolf.png',
    ghost: 'https://img.icons8.com/fluency/150/ghost.png',
    dragon: 'https://img.icons8.com/fluency/150/dragon.png',
    lion: 'https://img.icons8.com/fluency/150/lion.png'
};
const img = {}; Object.keys(assets).forEach(k => { img[k] = new Image(); img[k].src = assets[k]; });

// --- ÿßŸÑŸÄ 20 ŸÖÿ±ÿ≠ŸÑÿ© ---
const cities = ["London", "New York", "Paris", "Berlin", "Amsterdam", "Beijing", "Rome", "Moscow", "Athens", "Bucharest", "Tokyo", "Dubai", "Cairo", "Madrid", "Sydney", "Rio", "Seoul", "Istanbul", "Prague", "Latakia"];
const colors = ["#FFFF00", "#0066FF", "#FF0000", "#00FF00", "#FFFFFF", "#00FFFF", "#8B4513", "#800000", "#800080", "#000080", "#FF4500", "#FFD700", "#DAA520", "#32CD32", "#1E90FF", "#FF69B4", "#00CED1", "#A52A2A", "#556B2F", "#00f2ff"];

let game = {
    active: false, started: false, score: 0, cur: 0, dist: 0,
    p: {x: 150, y: 0, v: 0}, m: {x: -200, y: 0},
    obs: [], coins: [], best: localStorage.getItem('hBest') || 0,

    init() {
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        document.getElementById('bestVal').innerText = this.best;
        this.loop();
    },

    start() {
        document.getElementById('startScreen').style.display = 'none';
        this.score = 0; this.cur = 0; this.dist = 0; this.obs = []; this.coins = [];
        this.p.y = canvas.height/2; this.p.v = 0; this.m.x = -200;
        this.active = true; this.started = false;
    },

    playSfx(f) {
        if(!audioCtx) audioCtx = new AudioContext();
        let o = audioCtx.createOscillator(), g = audioCtx.createGain();
        o.frequency.value = f; g.gain.value = 0.1;
        o.connect(g).connect(audioCtx.destination);
        o.start(); o.stop(audioCtx.currentTime + 0.1);
    },

    die() {
        this.active = false; this.playSfx(150);
        if(this.score > this.best) { this.best = this.score; localStorage.setItem('hBest', this.best); }
        document.getElementById('startScreen').style.display = 'flex';
        this.init();
    },

    loop() {
        if (!game.active) { requestAnimationFrame(() => game.loop()); return; }
        let sColor = colors[game.cur];
        ctx.fillStyle = "#050508"; ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (game.started) {
            game.p.v += 0.55; game.p.y += game.p.v;
            game.m.y += (game.p.y - game.m.y) * 0.05;
            game.m.x = Math.min(game.p.x - 140, game.m.x + 0.4);
            game.dist += 2;

            if (game.dist > 1800 && game.cur < 19) { game.cur++; game.dist = 0; this.playSfx(600); }

            if (game.obs.length === 0 || game.obs[game.obs.length-1].x < canvas.width - 500) {
                game.obs.push({x: canvas.width, y: Math.random()*(canvas.height-400)+100, h: 280});
            }
            if (Math.random() < 0.01) game.coins.push({x: canvas.width, y: Math.random()*(canvas.height-100)+50});

            game.obs.forEach((o, i) => {
                o.x -= 7 + (game.cur * 0.4);
                ctx.fillStyle = sColor; ctx.globalAlpha = 0.5;
                ctx.fillRect(o.x, 0, 60, o.y); ctx.fillRect(o.x, o.y + o.h, 60, canvas.height);
                ctx.globalAlpha = 1; ctx.fillStyle = "white"; ctx.fillText(cities[game.cur].toUpperCase(), o.x+5, o.y-10);
                if (game.p.x+30 > o.x && game.p.x-30 < o.x+60 && (game.p.y+10 < o.y || game.p.y+70 > o.y+o.h)) game.die();
            });

            game.coins.forEach((c, i) => {
                c.x -= 7; ctx.drawImage(img.coin, c.x, c.y, 45, 45);
                if (Math.hypot(game.p.x - c.x, game.p.y - c.y) < 45) { game.score += 10; game.coins.splice(i, 1); game.playSfx(800); }
            });

            if (game.p.y > canvas.height || game.p.y < -50 || game.p.x < game.m.x + 80) game.die();
        }

        // ÿ±ÿ≥ŸÖ ÿßŸÑŸàÿ≠ÿ¥ (ŸäŸàÿßÿ¨Ÿá ÿßŸÑŸÇÿ∑ÿ©)
        ctx.save();
        ctx.translate(game.m.x + 150, game.m.y); ctx.scale(-1, 1);
        let mImg = (game.cur === 19) ? img.lion : (game.cur % 3 === 0 ? img.wolf : (game.cur % 3 === 1 ? img.ghost : img.dragon));
        ctx.drawImage(mImg, 0, 0, 150, 150);
        ctx.restore();

        // ÿ±ÿ≥ŸÖ ÿßŸÑŸÇÿ∑ÿ©
        ctx.drawImage(img.cat, game.p.x, game.p.y, 85, 85);

        document.getElementById('scoreVal').innerText = game.score;
        document.getElementById('locName').innerText = cities[game.cur].toUpperCase();
        requestAnimationFrame(() => game.loop());
    }
};

window.addEventListener('mousedown', () => { if(game.active) { game.started = true; game.p.v = -10; game.playSfx(400); } });
window.addEventListener('touchstart', (e) => { e.preventDefault(); if(game.active) { game.started = true; game.p.v = -10; game.playSfx(400); } });
window.onresize = () => game.init();
game.init();
</script>
</body>
</html>